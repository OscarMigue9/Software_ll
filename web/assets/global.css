/* Global tokens */
:root {
  --bg: #F5F7FA;
  --sidebar: #0F172A;
  --surface: #FFFFFF;
  --text: #0B1220;
  --text-muted: #6B7280;
  --primary: #3B82F6;
  --green: #22C55E;
  --red: #EF4444;
  --gold: #C8AD7F;

  --radius: 12px;
  --shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
  --ring: 0 0 0 3px rgba(59, 130, 246, 0.35);

  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;

  --sidebar-w-expanded: 240px;
  --sidebar-w-collapsed: 72px;
}

/* Reset & base */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font: 400 16px/1.45 Inter, "SF Pro Text", -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
img { max-width: 100%; height: auto; }
a { color: var(--primary); text-decoration: none; }
a:hover { text-decoration: underline; }

/* Focus visible */
:focus-visible { outline: 2px solid transparent; box-shadow: var(--ring); border-radius: 8px; }

/* Layout */
.app {
  display: grid;
  grid-template-columns: var(--sidebar-w, var(--sidebar-w-expanded)) 1fr;
  min-height: 100dvh;
}

#nav-toggle { position: absolute; opacity: 0; pointer-events: none; }

/* Sidebar */
.sidebar {
  background: var(--sidebar);
  color: #E5E7EB;
  position: sticky;
  top: 0;
  height: 100dvh;
  padding: var(--space-4) var(--space-3);
  transition: width .25s ease;
  width: var(--sidebar-w, var(--sidebar-w-expanded));
  overflow-x: hidden;
}
.sidebar .brand { display: flex; align-items: center; gap: var(--space-3); margin-bottom: var(--space-6); }
.sidebar .brand .logo { width: 36px; height: 36px; border-radius: 8px; background: #1F2937; display: grid; place-items: center; color: #C8AD7F; font-weight: 700; }
.sidebar .brand .title { font-weight: 600; white-space: nowrap; }

.nav { display: flex; flex-direction: column; gap: 4px; }
.nav a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  border-radius: 10px;
  color: #E5E7EB;
}
.nav a:hover { background: rgba(255,255,255,0.06); text-decoration: none; }
.nav a[aria-current="page"] { background: rgba(59,130,246,0.18); color: #fff; }
.nav .icon { width: 22px; height: 22px; flex: 0 0 22px; stroke: currentColor; }
.nav .label { white-space: nowrap; }

/* Collapse behavior via checkbox hack */
/* When checked, collapse sidebar */
#nav-toggle:checked ~ .sidebar { width: var(--sidebar-w-collapsed); }
#nav-toggle:checked ~ .sidebar .label { opacity: 0; pointer-events: none; }
#nav-toggle:checked ~ .sidebar .brand .title { opacity: 0; }
#nav-toggle:checked ~ .main .topbar .toggle-btn span { transform: rotate(180deg); }

/* Main */
.main { min-width: 0; }
.topbar {
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-4);
}
.toggle-btn { display: inline-flex; align-items: center; gap: 8px; }
.toggle-btn button {
  border: none; background: transparent; color: var(--text);
  width: 40px; height: 40px; border-radius: 8px; display: grid; place-items: center; cursor: pointer;
}
.toggle-btn button:hover { background: rgba(15, 23, 42, 0.06); }
.toggle-btn svg { width: 22px; height: 22px; }

.search {
  flex: 1; max-width: 520px; margin: 0 var(--space-4);
  display: flex; align-items: center; gap: 10px; background: var(--surface); border-radius: 10px; padding: 8px 12px; box-shadow: var(--shadow);
}
.search input { border: none; outline: none; flex: 1; font-size: 14px; }

.user { display: flex; align-items: center; gap: 12px; }
.avatar { width: 36px; height: 36px; border-radius: 50%; background: #E5E7EB; display: grid; place-items: center; font-weight: 600; }

.content { padding: 0 var(--space-4) var(--space-6); }

/* Grid helpers */
.grid { display: grid; gap: var(--space-4); }
.grid-3 {
  grid-template-columns: 1fr;
}
@media (min-width: 1200px) {
  .grid-3 { grid-template-columns: repeat(3, 1fr); }
}

/* Cards */
.card { background: var(--surface); border-radius: var(--radius); box-shadow: var(--shadow); padding: 16px; }
.card h3 { margin: 0 0 8px; font-weight: 600; }
.muted { color: var(--text-muted); }

/* KPI */
.kpi { display: flex; align-items: center; justify-content: space-between; }
.kpi .value { font-size: 28px; font-weight: 700; }
.pill { padding: 2px 8px; border-radius: 999px; font-size: 12px; font-weight: 600; }
.pill.green { background: rgba(34,197,94,0.12); color: #16A34A; }
.pill.red { background: rgba(239,68,68,0.12); color: #B91C1C; }
.pill.gold { background: rgba(200,173,127,0.16); color: #8B6F3D; }

/* Tables */
.table { width: 100%; border-collapse: collapse; }
.table th, .table td { text-align: left; padding: 10px 12px; vertical-align: middle; }
.table th { color: var(--text-muted); font-weight: 600; font-size: 13px; }
.table tbody tr { background: var(--surface); }
.table tbody tr:nth-child(odd) { background: #FAFBFC; }
.table tbody tr:hover { background: #F1F5F9; }
.table .actions { display: flex; gap: 8px; }
.status { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; padding: 2px 8px; border-radius: 999px; }
.status.success { background: rgba(34,197,94,0.12); color: #16A34A; }
.status.pending { background: rgba(59,130,246,0.12); color: #1D4ED8; }
.status.danger { background: rgba(239,68,68,0.12); color: #B91C1C; }
.status.warn { background: rgba(250,204,21,0.18); color: #92400E; }

/* Buttons */
.btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 14px; border-radius: 10px; border: 1px solid transparent; background: var(--surface); color: var(--text); cursor: pointer; min-height: 40px; }
.btn:hover { filter: brightness(0.98); }
.btn.primary { background: var(--primary); color: white; }
.btn.outline { background: transparent; border-color: #CBD5E1; }
.btn.ghost { background: transparent; color: var(--text-muted); }
.btn.danger { background: var(--red); color: white; }

/* Forms */
.field { display: grid; gap: 6px; }
.field label { font-weight: 600; font-size: 14px; }
.input, select, textarea { border: 1px solid #E5E7EB; border-radius: 10px; padding: 10px 12px; background: white; font-size: 14px; }
.error { color: var(--red); font-size: 12px; }

/* Right Preview Panel via :target */
.preview-panel { position: fixed; top: 0; right: 0; width: min(420px, 100%); height: 100dvh; background: var(--surface); box-shadow: -8px 0 24px rgba(15,23,42,0.08); transform: translateX(100%); transition: transform .25s ease; z-index: 50; padding: 16px; overflow-y: auto; }
.preview-panel h3 { margin-top: 0; }
.preview-panel .close { position: absolute; right: 12px; top: 12px; }
.overlay { position: fixed; inset: 0; background: rgba(2, 6, 23, 0.4); opacity: 0; pointer-events: none; transition: opacity .2s; z-index: 40; }
:target.overlay { opacity: 1; pointer-events: auto; }
:target + .preview-panel { transform: translateX(0%); }

/* Login */
.auth {
  min-height: 100dvh; display: grid; place-items: center; padding: var(--space-6);
  background:
    radial-gradient(800px 240px at 20% -10%, rgba(59,130,246,0.10), transparent 60%),
    radial-gradient(600px 200px at 100% 10%, rgba(34,197,94,0.10), transparent 60%),
    var(--bg);
}
.auth .card { width: min(440px, 100%); text-align: center; }
.auth .title { font-size: 22px; font-weight: 700; margin: 6px 0 12px; }
.auth .subtitle { color: var(--text-muted); margin-bottom: 16px; }

/* Utilities */
.row { display: flex; align-items: center; gap: 12px; }
.space-between { display: flex; justify-content: space-between; align-items: center; gap: 12px; }
.divider { height: 1px; background: #E5E7EB; margin: 12px 0; }
.badge { display: inline-flex; align-items: center; gap: 6px; padding: 2px 8px; border-radius: 999px; font-size: 12px; background: #EEF2FF; color: #3730A3; }
.chip { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 999px; font-size: 12px; background: #F3F4F6; color: #374151; }
.hint { font-size: 12px; color: var(--text-muted); }
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

/* Responsive tweaks */
@media (max-width: 767px) {
  .search { display: none; }
  .app { display: grid; grid-template-columns: 1fr; }
  .sidebar { position: fixed; top: 0; left: 0; bottom: 0; width: min(80vw, 280px); max-width: 280px; transform: translateX(-100%); transition: transform .25s ease; z-index: 1000; }
  #nav-toggle:checked ~ .app .sidebar { transform: translateX(0); }
  /* Overlay específico para el drawer móvil */
  #nav-overlay { position: fixed; inset: 0; background: rgba(2,6,23,0.45); opacity: 0; pointer-events: none; transition: opacity .2s ease; z-index: 900; }
  #nav-toggle:checked ~ #nav-overlay { opacity: 1; pointer-events: auto; }
  .card { padding: 12px; }
  /* Tablas desplazables */
  .table { display: block; width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; border-spacing: 0; }
  .table thead { position: sticky; top: 0; background: var(--surface); z-index: 1; box-shadow: 0 1px 0 rgba(0,0,0,.06); }
  .table th, .table td { white-space: nowrap; }
  /* Preview panel ocupa toda la pantalla */
  .preview-panel { width: 100vw !important; max-width: none !important; left: 0; right: 0; }
}
#nav-overlay:focus { outline: 2px solid var(--primary); outline-offset: -2px; }

/* Loading / Empty */
.spinner { width: 20px; height: 20px; border: 2px solid rgba(59,130,246,0.2); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
.empty { color: var(--text-muted); padding: 12px 0; }
